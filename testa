
currentIP="$(ifconfig | grep -Eo 'inet (addr:)?([0-9]*\.){3}[0-9]*' | grep -Eo '([0-9]*\.){3}[0-9]*' | grep -v '127.0.0.1')"
currentNet="$(echo $currentIP | cut -f 1,2,3 -d .)"


ipSet="$(nmap -T5 --max-parallelism=100 -oG - -n -sn -sP $currentNet.0/24 | awk '/Up$/{print $2}')"


while read -r candidateIp; do
	if [ "$(curl -sff $candidateIp/id)" = "usbBootstrapper" ]; then
		echo "Moederschip gevonden op $candidateIp!"
		remoteIsoHost=$candidateIp
	fi
done <<< "$ipSet"



